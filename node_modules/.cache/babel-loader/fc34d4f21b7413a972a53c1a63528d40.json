{"ast":null,"code":"import _slicedToArray from\"D:/my react project/pp/ChatAPP/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from\"react\";import TextField from\"@material-ui/core/TextField\";import{makeStyles}from\"@material-ui/core/styles\";import Grid from\"@material-ui/core/Grid\";import Messages from\"./Messages\";import IconButton from\"@material-ui/core/IconButton\";import{useParams}from\"react-router-dom\";import{db}from\"../Firebase/Firebase\";import firebase from\"firebase/app\";import ScrollableFeed from\"react-scrollable-feed\";import{BiHash}from\"react-icons/bi\";import{FiSend}from\"react-icons/fi\";import{GrEmoji}from\"react-icons/gr\";import{Picker}from\"emoji-mart\";import{RiImageAddLine}from\"react-icons/ri\";import FileUpload from\"./FileUpload\";import\"emoji-mart/css/emoji-mart.css\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var useStyles=makeStyles(function(theme){return{root:{flexGrow:1},chat:{position:\"relative\",height:\"calc(100vh - 200px)\",paddingLeft:\"10px\",paddingBottom:\"5px\",paddingTop:\"5px\"},footer:{paddingRight:\"15px\",paddingLeft:\"15px\",paddingTop:\"10px\"},message:{width:\"100%\",color:\"white\"},roomName:{border:\"1px solid #0000004a\",borderLeft:0,borderRight:0,padding:\"15px\",display:\"flex\",color:\"#e5e5e5\"},roomNameText:{marginBlockEnd:0,marginBlockStart:0,paddingLeft:\"5px\"},iconDesign:{fontSize:\"1.5em\",color:\"#e5e5e5\"},footerContent:{display:\"flex\",backgroundColor:\"#303753\",borderRadius:\"5px\",alignItems:\"center\"},inputFile:{display:\"none\"}};});function Chat(){var classes=useStyles();var params=useParams();var _useState=useState([]),_useState2=_slicedToArray(_useState,2),allMessages=_useState2[0],setAllMessages=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),channelName=_useState4[0],setChannelName=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),userNewMsg=_useState6[0],setUserNewMsg=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),emojiBtn=_useState8[0],setEmojiBtn=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),modalState=_useState10[0],setModalState=_useState10[1];var _useState11=useState(null),_useState12=_slicedToArray(_useState11,2),file=_useState12[0],setFileName=_useState12[1];useEffect(function(){if(params.id){db.collection(\"channels\").doc(params.id).onSnapshot(function(snapshot){var _snapshot$data;setChannelName((_snapshot$data=snapshot.data())===null||_snapshot$data===void 0?void 0:_snapshot$data.channelName);});db.collection(\"channels\").doc(params.id).collection(\"messages\").orderBy(\"timestamp\",\"asc\").onSnapshot(function(snapshot){setAllMessages(snapshot.docs.map(function(doc){return{id:doc.id,data:doc.data()};}));});}},[params]);var sendMsg=function sendMsg(e){e.preventDefault();if(userNewMsg&&params.id){var userData=JSON.parse(localStorage.getItem(\"userDetails\"));if(userData){var displayName=userData.displayName;var imgUrl=userData.photoURL;var uid=userData.uid;var likeCount=0;var likes={};var fireCount=0;var fire={};var heartCount=0;var heart={};var postImg=null;var obj={text:userNewMsg,timestamp:firebase.firestore.Timestamp.now(),userImg:imgUrl,userName:displayName,uid:uid,likeCount:likeCount,likes:likes,fireCount:fireCount,fire:fire,heartCount:heartCount,heart:heart,postImg:postImg};db.collection(\"channels\").doc(params.id).collection(\"messages\").add(obj).then(function(res){console.log(\"message sent\");}).catch(function(err){console.log(err);});}setUserNewMsg(\"\");setEmojiBtn(false);}};var addEmoji=function addEmoji(e){setUserNewMsg(userNewMsg+e.native);};var openModal=function openModal(){setModalState(!modalState);};var handelFileUpload=function handelFileUpload(e){e.preventDefault();if(e.target.files[0]){setFileName(e.target.files[0]);openModal();}e.target.value=null;};return/*#__PURE__*/_jsxs(\"div\",{className:classes.root,children:[modalState?/*#__PURE__*/_jsx(FileUpload,{setState:openModal,file:file}):null,/*#__PURE__*/_jsxs(Grid,{item:true,xs:12,className:classes.roomName,children:[/*#__PURE__*/_jsx(BiHash,{className:classes.iconDesign}),/*#__PURE__*/_jsx(\"h3\",{className:classes.roomNameText,children:channelName})]}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,className:classes.chat,children:/*#__PURE__*/_jsx(ScrollableFeed,{children:allMessages.map(function(message){return/*#__PURE__*/_jsx(Messages,{values:message.data,msgId:message.id},message.id);})})}),/*#__PURE__*/_jsx(\"div\",{className:classes.footer,children:/*#__PURE__*/_jsxs(Grid,{item:true,xs:12,className:classes.footerContent,children:[/*#__PURE__*/_jsx(\"input\",{accept:\"image/*\",className:classes.inputFile,id:\"icon-button-file\",type:\"file\",onChange:function onChange(e){return handelFileUpload(e);}}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"icon-button-file\",children:/*#__PURE__*/_jsx(IconButton,{color:\"primary\",\"aria-label\":\"upload picture\",component:\"span\",children:/*#__PURE__*/_jsx(RiImageAddLine,{style:{color:\"#b9bbbe\"}})})}),/*#__PURE__*/_jsx(IconButton,{color:\"primary\",component:\"button\",onClick:function onClick(){return setEmojiBtn(!emojiBtn);},children:/*#__PURE__*/_jsx(GrEmoji,{style:{color:\"#b9bbbe\"}})}),emojiBtn?/*#__PURE__*/_jsx(Picker,{onSelect:addEmoji,theme:\"dark\"}):null,/*#__PURE__*/_jsxs(\"form\",{autoComplete:\"off\",style:{width:\"100%\",display:\"flex\"},onSubmit:function onSubmit(e){return sendMsg(e);},children:[/*#__PURE__*/_jsx(TextField,{className:classes.message,required:true,id:\"outlined-basic\",label:\"Enter Message\",variant:\"outlined\",multiline:true,rows:1,rowsMax:2,value:userNewMsg,onChange:function onChange(e){setUserNewMsg(e.target.value);}}),/*#__PURE__*/_jsx(IconButton,{type:\"submit\",component:\"button\",children:/*#__PURE__*/_jsx(FiSend,{style:{color:\"#b9bbbe\"}})})]})]})})]});}export default Chat;","map":{"version":3,"sources":["D:/my react project/pp/ChatAPP/src/Components/Chat.js"],"names":["React","useEffect","useState","TextField","makeStyles","Grid","Messages","IconButton","useParams","db","firebase","ScrollableFeed","BiHash","FiSend","GrEmoji","Picker","RiImageAddLine","FileUpload","useStyles","theme","root","flexGrow","chat","position","height","paddingLeft","paddingBottom","paddingTop","footer","paddingRight","message","width","color","roomName","border","borderLeft","borderRight","padding","display","roomNameText","marginBlockEnd","marginBlockStart","iconDesign","fontSize","footerContent","backgroundColor","borderRadius","alignItems","inputFile","Chat","classes","params","allMessages","setAllMessages","channelName","setChannelName","userNewMsg","setUserNewMsg","emojiBtn","setEmojiBtn","modalState","setModalState","file","setFileName","id","collection","doc","onSnapshot","snapshot","data","orderBy","docs","map","sendMsg","e","preventDefault","userData","JSON","parse","localStorage","getItem","displayName","imgUrl","photoURL","uid","likeCount","likes","fireCount","fire","heartCount","heart","postImg","obj","text","timestamp","firestore","Timestamp","now","userImg","userName","add","then","res","console","log","catch","err","addEmoji","native","openModal","handelFileUpload","target","files","value"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport TextField from \"@material-ui/core/TextField\";\r\nimport { makeStyles } from \"@material-ui/core/styles\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport Messages from \"./Messages\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport { useParams } from \"react-router-dom\";\r\nimport { db } from \"../Firebase/Firebase\";\r\nimport firebase from \"firebase/app\";\r\nimport ScrollableFeed from \"react-scrollable-feed\";\r\nimport { BiHash } from \"react-icons/bi\";\r\nimport { FiSend } from \"react-icons/fi\";\r\nimport { GrEmoji } from \"react-icons/gr\";\r\nimport { Picker } from \"emoji-mart\";\r\nimport { RiImageAddLine } from \"react-icons/ri\";\r\nimport FileUpload from \"./FileUpload\";\r\nimport \"emoji-mart/css/emoji-mart.css\";\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  root: {\r\n    flexGrow: 1,\r\n  },\r\n  chat: {\r\n    position: \"relative\",\r\n    height: \"calc(100vh - 200px)\",\r\n    paddingLeft: \"10px\",\r\n    paddingBottom: \"5px\",\r\n    paddingTop: \"5px\",\r\n  },\r\n  footer: {\r\n    paddingRight: \"15px\",\r\n    paddingLeft: \"15px\",\r\n    paddingTop: \"10px\",\r\n  },\r\n  message: {\r\n    width: \"100%\",\r\n    color: \"white\",\r\n  },\r\n  roomName: {\r\n    border: \"1px solid #0000004a\",\r\n    borderLeft: 0,\r\n    borderRight: 0,\r\n    padding: \"15px\",\r\n    display: \"flex\",\r\n    color: \"#e5e5e5\",\r\n  },\r\n  roomNameText: {\r\n    marginBlockEnd: 0,\r\n    marginBlockStart: 0,\r\n    paddingLeft: \"5px\",\r\n  },\r\n  iconDesign: {\r\n    fontSize: \"1.5em\",\r\n    color: \"#e5e5e5\",\r\n  },\r\n  footerContent: {\r\n    display: \"flex\",\r\n    backgroundColor: \"#303753\",\r\n    borderRadius: \"5px\",\r\n    alignItems: \"center\",\r\n  },\r\n  inputFile: {\r\n    display: \"none\",\r\n  },\r\n}));\r\n\r\nfunction Chat() {\r\n  const classes = useStyles();\r\n  const params = useParams();\r\n  const [allMessages, setAllMessages] = useState([]);\r\n  const [channelName, setChannelName] = useState(\"\");\r\n  const [userNewMsg, setUserNewMsg] = useState(\"\");\r\n  const [emojiBtn, setEmojiBtn] = useState(false);\r\n  const [modalState, setModalState] = useState(false);\r\n  const [file, setFileName] = useState(null);\r\n\r\n  useEffect(() => {\r\n    if (params.id) {\r\n      db.collection(\"channels\")\r\n        .doc(params.id)\r\n        .onSnapshot((snapshot) => {\r\n          setChannelName(snapshot.data()?.channelName);\r\n        });\r\n\r\n      db.collection(\"channels\")\r\n        .doc(params.id)\r\n        .collection(\"messages\")\r\n        .orderBy(\"timestamp\", \"asc\")\r\n        .onSnapshot((snapshot) => {\r\n          setAllMessages(\r\n            snapshot.docs.map((doc) => ({ id: doc.id, data: doc.data() }))\r\n          );\r\n        });\r\n    }\r\n  }, [params]);\r\n\r\n  const sendMsg = (e) => {\r\n    e.preventDefault();\r\n    if (userNewMsg && params.id) {\r\n      const userData = JSON.parse(localStorage.getItem(\"userDetails\"));\r\n\r\n      if (userData) {\r\n        const displayName = userData.displayName;\r\n        const imgUrl = userData.photoURL;\r\n        const uid = userData.uid;\r\n        const likeCount = 0;\r\n        const likes = {};\r\n        const fireCount = 0;\r\n        const fire = {};\r\n        const heartCount = 0;\r\n        const heart = {};\r\n        const postImg = null;\r\n        const obj = {\r\n          text: userNewMsg,\r\n          timestamp: firebase.firestore.Timestamp.now(),\r\n          userImg: imgUrl,\r\n          userName: displayName,\r\n          uid: uid,\r\n          likeCount: likeCount,\r\n          likes: likes,\r\n          fireCount: fireCount,\r\n          fire: fire,\r\n          heartCount: heartCount,\r\n          heart: heart,\r\n          postImg: postImg,\r\n        };\r\n\r\n        db.collection(\"channels\")\r\n          .doc(params.id)\r\n          .collection(\"messages\")\r\n          .add(obj)\r\n          .then((res) => {\r\n            console.log(\"message sent\");\r\n          })\r\n          .catch((err) => {\r\n            console.log(err);\r\n          });\r\n      }\r\n\r\n      setUserNewMsg(\"\");\r\n      setEmojiBtn(false);\r\n    }\r\n  };\r\n\r\n  const addEmoji = (e) => {\r\n    setUserNewMsg(userNewMsg + e.native);\r\n  };\r\n\r\n  const openModal = () => {\r\n    setModalState(!modalState);\r\n  };\r\n\r\n  const handelFileUpload = (e) => {\r\n    e.preventDefault();\r\n    if (e.target.files[0]) {\r\n      setFileName(e.target.files[0]);\r\n      openModal();\r\n    }\r\n    e.target.value = null;\r\n  };\r\n\r\n  return (\r\n    <div className={classes.root}>\r\n      {modalState ? <FileUpload setState={openModal} file={file} /> : null}\r\n      <Grid item xs={12} className={classes.roomName}>\r\n        <BiHash className={classes.iconDesign} />\r\n        <h3 className={classes.roomNameText}>{channelName}</h3>\r\n      </Grid>\r\n      <Grid item xs={12} className={classes.chat}>\r\n        <ScrollableFeed>\r\n          {allMessages.map((message) => (\r\n            <Messages\r\n              key={message.id}\r\n              values={message.data}\r\n              msgId={message.id}\r\n            />\r\n          ))}\r\n        </ScrollableFeed>\r\n      </Grid>\r\n      <div className={classes.footer}>\r\n        <Grid item xs={12} className={classes.footerContent}>\r\n          <input\r\n            accept=\"image/*\"\r\n            className={classes.inputFile}\r\n            id=\"icon-button-file\"\r\n            type=\"file\"\r\n            onChange={(e) => handelFileUpload(e)}\r\n          />\r\n          <label htmlFor=\"icon-button-file\">\r\n            <IconButton\r\n              color=\"primary\"\r\n              aria-label=\"upload picture\"\r\n              component=\"span\"\r\n            >\r\n              <RiImageAddLine style={{ color: \"#b9bbbe\" }} />\r\n            </IconButton>\r\n          </label>\r\n\r\n          <IconButton\r\n            color=\"primary\"\r\n            component=\"button\"\r\n            onClick={() => setEmojiBtn(!emojiBtn)}\r\n          >\r\n            <GrEmoji style={{ color: \"#b9bbbe\" }} />\r\n          </IconButton>\r\n          {emojiBtn ? <Picker onSelect={addEmoji} theme=\"dark\" /> : null}\r\n\r\n          <form\r\n            autoComplete=\"off\"\r\n            style={{ width: \"100%\", display: \"flex\" }}\r\n            onSubmit={(e) => sendMsg(e)}\r\n          >\r\n            <TextField\r\n              className={classes.message}\r\n              required\r\n              id=\"outlined-basic\"\r\n              label=\"Enter Message\"\r\n              variant=\"outlined\"\r\n              multiline\r\n              rows={1}\r\n              rowsMax={2}\r\n              value={userNewMsg}\r\n              onChange={(e) => {\r\n                setUserNewMsg(e.target.value);\r\n              }}\r\n            />\r\n            <IconButton type=\"submit\" component=\"button\">\r\n              <FiSend style={{ color: \"#b9bbbe\" }} />\r\n            </IconButton>\r\n          </form>\r\n        </Grid>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Chat;\r\n"]},"metadata":{},"sourceType":"module"}