{"ast":null,"code":"import _slicedToArray from\"D:/my react project/pp/ChatAPP/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState}from\"react\";import{makeStyles}from\"@material-ui/core/styles\";import Button from\"@material-ui/core/Button\";import Dialog from\"@material-ui/core/Dialog\";import DialogActions from\"@material-ui/core/DialogActions\";import DialogContent from\"@material-ui/core/DialogContent\";import DialogTitle from\"@material-ui/core/DialogTitle\";import TextField from\"@material-ui/core/TextField\";import LinearProgress from\"@material-ui/core/LinearProgress\";import Typography from\"@material-ui/core/Typography\";import Box from\"@material-ui/core/Box\";import{storage}from\"../Firebase/Firebase\";import{useParams}from\"react-router-dom\";import firebase from\"firebase/app\";import{db}from\"../Firebase/Firebase\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var useStyles=makeStyles(function(theme){return{displayImage:{height:\"105px\",width:\"180px\"},imageName:{paddingLeft:\"15px\",fontSize:\"1.3em\"},imageDiv:{marginLeft:\"16px\",marginRight:\"16px\",marginTop:\"-33px\"}};});function FileUpload(_ref){var setState=_ref.setState,file=_ref.file;var params=useParams();var classes=useStyles();var _useState=useState(true),_useState2=_slicedToArray(_useState,2),open=_useState2[0],setOpen=_useState2[1];var _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),progress=_useState4[0],setProgress=_useState4[1];var _useState5=useState({display:\"none\"}),_useState6=_slicedToArray(_useState5,2),progressBar=_useState6[0],setProgressBar=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),message=_useState8[0],setMessage=_useState8[1];var handleClose=function handleClose(){setOpen(false);setState();};var sendMsg=function sendMsg(downloadURL){if(params.id){var userData=JSON.parse(localStorage.getItem(\"userDetails\"));if(userData){var displayName=userData.displayName;var imgUrl=userData.photoURL;var uid=userData.uid;var likeCount=0;var likes={};var fireCount=0;var fire={};var heartCount=0;var heart={};var postImg=downloadURL;var obj={text:message,timestamp:firebase.firestore.Timestamp.now(),userImg:imgUrl,userName:displayName,uid:uid,likeCount:likeCount,likes:likes,fireCount:fireCount,fire:fire,heartCount:heartCount,heart:heart,postImg:postImg};db.collection(\"channels\").doc(params.id).collection(\"messages\").add(obj).then(function(res){console.log(\"message sent\");}).catch(function(err){console.log(err);});}setMessage(\"\");}};var fileObj=URL.createObjectURL(file);var handleUpload=function handleUpload(e){e.preventDefault();setProgressBar({display:\"block\"});var uploadRef=storage.ref(\"images/\".concat(file.name)).put(file);uploadRef.on(\"state_changed\",function(snapshot){// Observe state change events such as progress, pause, and resume\n// Get task progress, including the number of bytes uploaded and the total number of bytes to be uploaded\nvar progress=snapshot.bytesTransferred/snapshot.totalBytes*100;setProgress(progress);},function(error){console.log(error);},function(){// Handle successful uploads on complete\n// For instance, get the download URL: https://firebasestorage.googleapis.com/...\nuploadRef.snapshot.ref.getDownloadURL().then(function(downloadURL){sendMsg(downloadURL);});handleClose();});};return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(Dialog,{open:open,onClose:handleClose,\"aria-labelledby\":\"alert-dialog-title\",\"aria-describedby\":\"alert-dialog-description\",children:[/*#__PURE__*/_jsxs(\"div\",{className:classes.imageDiv,children:[/*#__PURE__*/_jsx(\"img\",{src:fileObj,alt:file.name,className:classes.displayImage}),/*#__PURE__*/_jsx(Typography,{className:classes.imageName,children:file.name})]}),/*#__PURE__*/_jsx(DialogTitle,{id:\"alert-dialog-title\",children:\"Upload Image\"}),/*#__PURE__*/_jsxs(DialogContent,{children:[/*#__PURE__*/_jsx(\"form\",{autoComplete:\"off\",onSubmit:function onSubmit(e){handleUpload(e);},children:/*#__PURE__*/_jsx(TextField,{id:\"outlined-basic\",label:\"Add A Message\",fullWidth:true,margin:\"normal\",variant:\"outlined\",style:{backgroundColor:\"rgb(45, 45, 73)\",borderRadius:\"5px\"},onChange:function onChange(e){setMessage(e.target.value);}})}),/*#__PURE__*/_jsx(\"div\",{style:progressBar,children:/*#__PURE__*/_jsxs(Box,{display:\"flex\",alignItems:\"center\",children:[/*#__PURE__*/_jsx(Box,{width:\"100%\",mr:1,children:/*#__PURE__*/_jsx(LinearProgress,{variant:\"determinate\",value:progress})}),/*#__PURE__*/_jsx(Box,{minWidth:35,children:/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",children:[Math.round(progress),\"%\"]})})]})})]}),/*#__PURE__*/_jsxs(DialogActions,{children:[/*#__PURE__*/_jsx(Button,{onClick:handleClose,style:{color:\"white\"},children:\"Cancel\"}),/*#__PURE__*/_jsx(Button,{type:\"submit\",onClick:function onClick(e){return handleUpload(e);},color:\"primary\",autoFocus:true,variant:\"contained\",children:\"Upload\"})]})]})});}export default FileUpload;","map":{"version":3,"sources":["D:/my react project/pp/ChatAPP/src/Components/FileUpload.js"],"names":["React","useState","makeStyles","Button","Dialog","DialogActions","DialogContent","DialogTitle","TextField","LinearProgress","Typography","Box","storage","useParams","firebase","db","useStyles","theme","displayImage","height","width","imageName","paddingLeft","fontSize","imageDiv","marginLeft","marginRight","marginTop","FileUpload","setState","file","params","classes","open","setOpen","progress","setProgress","display","progressBar","setProgressBar","message","setMessage","handleClose","sendMsg","downloadURL","id","userData","JSON","parse","localStorage","getItem","displayName","imgUrl","photoURL","uid","likeCount","likes","fireCount","fire","heartCount","heart","postImg","obj","text","timestamp","firestore","Timestamp","now","userImg","userName","collection","doc","add","then","res","console","log","catch","err","fileObj","URL","createObjectURL","handleUpload","e","preventDefault","uploadRef","ref","name","put","on","snapshot","bytesTransferred","totalBytes","error","getDownloadURL","backgroundColor","borderRadius","target","value","Math","round","color"],"mappings":"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","sourcesContent":["import React, { useState } from \"react\";\r\nimport { makeStyles } from \"@material-ui/core/styles\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport DialogActions from \"@material-ui/core/DialogActions\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\r\nimport TextField from \"@material-ui/core/TextField\";\r\nimport LinearProgress from \"@material-ui/core/LinearProgress\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport Box from \"@material-ui/core/Box\";\r\nimport { storage } from \"../Firebase/Firebase\";\r\nimport { useParams } from \"react-router-dom\";\r\nimport firebase from \"firebase/app\";\r\nimport { db } from \"../Firebase/Firebase\";\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  displayImage: {\r\n    height: \"105px\",\r\n    width: \"180px\",\r\n  },\r\n  imageName: {\r\n    paddingLeft: \"15px\",\r\n    fontSize: \"1.3em\",\r\n  },\r\n  imageDiv: {\r\n    marginLeft: \"16px\",\r\n    marginRight: \"16px\",\r\n    marginTop: \"-33px\",\r\n  },\r\n}));\r\n\r\nfunction FileUpload({ setState, file }) {\r\n  const params = useParams();\r\n  const classes = useStyles();\r\n  const [open, setOpen] = useState(true);\r\n  const [progress, setProgress] = useState(0);\r\n  const [progressBar, setProgressBar] = useState({ display: \"none\" });\r\n  const [message, setMessage] = useState(\"\");\r\n\r\n  const handleClose = () => {\r\n    setOpen(false);\r\n    setState();\r\n  };\r\n\r\n  const sendMsg = (downloadURL) => {\r\n    if (params.id) {\r\n      const userData = JSON.parse(localStorage.getItem(\"userDetails\"));\r\n\r\n      if (userData) {\r\n        const displayName = userData.displayName;\r\n        const imgUrl = userData.photoURL;\r\n        const uid = userData.uid;\r\n        const likeCount = 0;\r\n        const likes = {};\r\n        const fireCount = 0;\r\n        const fire = {};\r\n        const heartCount = 0;\r\n        const heart = {};\r\n        const postImg = downloadURL;\r\n        const obj = {\r\n          text: message,\r\n          timestamp: firebase.firestore.Timestamp.now(),\r\n          userImg: imgUrl,\r\n          userName: displayName,\r\n          uid: uid,\r\n          likeCount: likeCount,\r\n          likes: likes,\r\n          fireCount: fireCount,\r\n          fire: fire,\r\n          heartCount: heartCount,\r\n          heart: heart,\r\n          postImg: postImg,\r\n        };\r\n\r\n        db.collection(\"channels\")\r\n          .doc(params.id)\r\n          .collection(\"messages\")\r\n          .add(obj)\r\n          .then((res) => {\r\n            console.log(\"message sent\");\r\n          })\r\n          .catch((err) => {\r\n            console.log(err);\r\n          });\r\n      }\r\n\r\n      setMessage(\"\");\r\n    }\r\n  };\r\n\r\n  const fileObj = URL.createObjectURL(file);\r\n\r\n  const handleUpload = (e) => {\r\n    e.preventDefault();\r\n    setProgressBar({ display: \"block\" });\r\n    const uploadRef = storage.ref(`images/${file.name}`).put(file);\r\n    uploadRef.on(\r\n      \"state_changed\",\r\n      (snapshot) => {\r\n        // Observe state change events such as progress, pause, and resume\r\n        // Get task progress, including the number of bytes uploaded and the total number of bytes to be uploaded\r\n        let progress = (snapshot.bytesTransferred / snapshot.totalBytes) * 100;\r\n        setProgress(progress);\r\n      },\r\n      (error) => {\r\n        console.log(error);\r\n      },\r\n      () => {\r\n        // Handle successful uploads on complete\r\n        // For instance, get the download URL: https://firebasestorage.googleapis.com/...\r\n        uploadRef.snapshot.ref.getDownloadURL().then((downloadURL) => {\r\n          sendMsg(downloadURL);\r\n        });\r\n        handleClose();\r\n      }\r\n    );\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <Dialog\r\n        open={open}\r\n        onClose={handleClose}\r\n        aria-labelledby=\"alert-dialog-title\"\r\n        aria-describedby=\"alert-dialog-description\"\r\n      >\r\n        <div className={classes.imageDiv}>\r\n          <img src={fileObj} alt={file.name} className={classes.displayImage} />\r\n          <Typography className={classes.imageName}>{file.name}</Typography>\r\n        </div>\r\n\r\n        <DialogTitle id=\"alert-dialog-title\">Upload Image</DialogTitle>\r\n\r\n        <DialogContent>\r\n          <form\r\n            autoComplete=\"off\"\r\n            onSubmit={(e) => {\r\n              handleUpload(e);\r\n            }}\r\n          >\r\n            <TextField\r\n              id=\"outlined-basic\"\r\n              label=\"Add A Message\"\r\n              fullWidth\r\n              margin=\"normal\"\r\n              variant=\"outlined\"\r\n              style={{\r\n                backgroundColor: \"rgb(45, 45, 73)\",\r\n                borderRadius: \"5px\",\r\n              }}\r\n              onChange={(e) => {\r\n                setMessage(e.target.value);\r\n              }}\r\n            />\r\n          </form>\r\n\r\n          <div style={progressBar}>\r\n            <Box display=\"flex\" alignItems=\"center\">\r\n              <Box width=\"100%\" mr={1}>\r\n                <LinearProgress variant=\"determinate\" value={progress} />\r\n              </Box>\r\n              <Box minWidth={35}>\r\n                <Typography variant=\"body2\">{Math.round(progress)}%</Typography>\r\n              </Box>\r\n            </Box>\r\n          </div>\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button onClick={handleClose} style={{ color: \"white\" }}>\r\n            Cancel\r\n          </Button>\r\n          <Button\r\n            type=\"submit\"\r\n            onClick={(e) => handleUpload(e)}\r\n            color=\"primary\"\r\n            autoFocus\r\n            variant=\"contained\"\r\n          >\r\n            Upload\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default FileUpload;\r\n"]},"metadata":{},"sourceType":"module"}